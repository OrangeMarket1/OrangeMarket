<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="orange.service.impl.ProductMapper">
	
	<!-- insert -->
	
	<!-- 제품 등록 -->
	<insert id="insertProduct" parameterType="productVO">
	
		INSERT INTO product
			(pro_code,
			seller,
			pro_category_code,
			title,
			keyword,
			addr,
			price,
			content,
			rdate,
			udate,
			imgs)
		
     VALUES (PRODUCT_SEQ.NEXTVAL,
			#{seller},
			#{proCategoryCode},
			#{title},
			#{keyword},
			#{addr},
			#{price},
			#{content},
			sysdate,
			sysdate,
			#{imgs})
	
	</insert>
	
	
	
	<!-- select -->
	
	<!-- 제품 리스트 표시 -->
	<select id="selectProductList" resultType="egovMap">
		SELECT
			pro_code,
			title,
			price,
			addr,
			imgs
		FROM 
			product
			
		ORDER BY
			rdate DESC
			
	</select>
	
	<!-- 카테고리별 제품 리스트 표시 -->
	<select id="selectProductCategoryList" resultType="egovMap">
		SELECT
			pro_code,
			title,
			price,
			addr,
			imgs
		FROM 
			product
			
		WHERE
			pro_category_code = ${proCategoryCode}
			
		ORDER BY
			rdate DESC
			
	</select>
	
	<!-- 카테고리명 표시 -->
	<select id="selectProCategory" resultType="string">
		SELECT
		    category
		FROM
		    pro_category
		WHERE
		    pro_category_code = ${proCategoryCode}
			
	</select>
	
	<!-- 제품 상세보기 -->
	<select id="selectProductDetail" resultType="productVO">
		SELECT
			pro_code,
			seller,
			pro_category_code,
			title,
			keyword,
			addr,
			price,
			content,
			rdate,
			udate,
			status,
			hits,
			nvl(buyer, '0') as buyer,
			refund,
			nego,
			( select nik_name from member where user_id = p.seller) seller_nik,
			nvl(buyer_nik, '0') as buyer_nik,
			imgs
			
		FROM 
			product p
			
		WHERE
			pro_code = ${proCode}

	</select>
	
	<!-- 수정 위한 제품 데이터 보기 -->
	<select id="selectProductModify" resultType="productVO">
		SELECT
			pro_code,
			seller,
			pro_category_code,
			title,
			keyword,
			addr,
			price,
			content,
			rdate,
			udate,
			seller_nik,
			imgs
			
		FROM
			product
			
		WHERE
			pro_code = ${proCode}
	</select>
	
	<!-- 글 작서 시 자동완성 될 주소 받아오기 -->
	<select id="selectProductAddr" resultType="productVO">
		SELECT
			user_id,
			addr
			
		FROM
			member
		
		WHERE
			user_id = ${seller}
	</select>
	
	<!-- select end -->
	


</mapper>